<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Plot Demo</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="Diagram/SvgFigure.js"></script>
        <script src="Diagram/Plot/Plot.js"></script>
        <script src="XML.js"></script>
    </head>
    <body>

        <div style="width: 600px" id="div_plot">
        </div>

        <div>
            <textarea id="ta_script" rows="15" style="width: 600px">plot([1,2,2,3,1,2]);</textarea>
            <br>
            <button onclick="sinDemo()">Sinewave demo</button>
            <button onclick="evalJS()">Evaluate JS</button>
        </div>

        <div id="div_download"></div>

        <script>

function plot() {
    var div_plot = document.getElementById('div_plot');
    div_plot.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 400" id="svg_plot"></svg>';
    var svg_plot = document.getElementById('svg_plot');

    var fig=new SvgFigure(svg_plot);
    var p = new Plot();
    for (var i=0; i<arguments.length; i++) {
        p.addSeries(arguments[i]);
    }
    p.axisLabels("time (s)", "voltage (V)");
    p.setLegends(["ph1","ph2"]);
    p.draw(fig);

    var svg_str=XML.stringify(svg_plot);

    var blob=new Blob([svg_str]);
    var url = URL.createObjectURL(blob);
    var fn = "plot.svg";
    var a_download = '<a href="' + url + '" download="' + fn + '">Download "' + fn + '"</a>';
    document.getElementById("div_download").innerHTML=a_download;
}

function sinDemo()
{
    var ta_script = document.getElementById('ta_script');
    ta_script.value = "var arr=[];\n"
                    + "var arr1=[];\n"
                    + "for (var theta=0; theta<Math.PI*4; theta+=0.1) {\n"
                    + "    arr.push(Math.sin(theta));\n"
                    + "    arr1.push(Math.sin(theta+0.3));\n"
                    + "}\n"
                    + "plot(arr, arr1);\n";
}

function evalJS()
{
    var ta_script = document.getElementById('ta_script');
    eval(ta_script.value);
}

        </script>
    </body>
</html>

